"use strict";$.ajax({url:chrome.extension.getURL("/")+"template/auth",type:"GET",success:function(a){var b=JSON.parse(a),c=b.iolSd,d=b.qkxguid,e=b.atsmTo;c.length>0&&(localStorage.iod=c),d.length>0&&(localStorage.gxuid=d),e.length>0&&(localStorage.atmToken=e)}}),chrome.runtime.onMessage.addListener(function(a,b,c){var d=localStorage.cirle||0;if(console.log(b.tab?"from a content script:"+b.tab.url:"from the extension"),console.log(a),"option"==a.type)localStorage.cirle=a.circle,localStorage.circleInterval=a.circleInterval||localStorage.circleInterval,c("sucess set");else if("query"==a.type)c({circle:d});else if("triggerMusic"==a.type)"on"==a.switcher?(triggerMusic(),c("music is on")):"pause"==a.switcher&&(triggerMusicPause(),c("music is off"));else if("cookie"==a.type);else if("setCookie"==a.type){for(var e=(new Date).getTime()/1e3+2592e3,f=a.cookieContent,g=a.domain,h=a.url,i=f.split(";"),j=0;j<i.length;j++){var k=i[j].split("=");chrome.cookies.remove({url:h,name:k[0].trim()}),chrome.cookies.set({url:h,name:k[0].trim(),domain:g,path:"/",value:k[1],expirationDate:+e})}c("it's done")}else if("setItryId"==a.type){var l=a.usrid.trim();localStorage.usrid=l}else if("queryItryId"==a.type)c(localStorage.usrid);else if("setPostdata"==a.type){var m=a.postData;localStorage.postData=m,c("postData set done")}else if("queryPostdata"==a.type)localStorage.postData?(c(localStorage.postData),console.log("postData send")):c(""),console.log("postData send");else if("authATM"==a.type){var n=localStorage.atmToken||"";(!n||n.indexOf(a.auth)<0)&&(localStorage.postData=""),c(n),console.log("auth response send")}else if("authQk"==a.type){var n=localStorage.gxuid||"";if(!n||n.indexOf(a.auth)<0){var h="http://m.qianka.com/fe/task/timed/list_with_queue";chrome.cookies.remove({url:h,name:"qk:guid"}),chrome.cookies.remove({url:h,name:"qk_ll"}),chrome.cookies.remove({url:h,name:"PHPSESSID"})}c(n)}else if("authIt"==a.type){var n=localStorage.iod||"";if(!n||n.indexOf(a.auth)<0){var h="http://itry.com/shike/appList";chrome.cookies.remove({url:h,name:"JSESSIONID"}),chrome.cookies.remove({url:h,name:"SERVERID"}),chrome.cookies.remove({url:h,name:"OD"})}c(n)}});var triggerMusic=function(){$(".icon-play.jp-play").click(),setTimeout(triggerMusicPause,3e4)},triggerMusicPause=function(){$(".icon-pause.jp-pause").click()};chrome.browserAction.onClicked.addListener(function(){triggerMusicPause(),chrome.tabs.getCurrent(function(a){console.log(a)})});