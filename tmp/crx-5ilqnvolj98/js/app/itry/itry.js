define("app/itry/itry",[],function(require,exports){function itryAssert(a,b){console.log("-------try Sniffer-----------");var c=0,d=5,e=setInterval(function(){0==d||$(a.fininishTag).children().length>0||$(a.taskPattern).children().length>0?(clearInterval(e),$(a.fetchTrigger).each(function(){"剩余0个"!=$(this).find("p span:last").text()&&!$(this).find("div.app_name h3 font").length>0&&c++}),console.log("-------count-----------"+d),0==c&&paraMng.modelSwitch(),b(a,c)):d--},200)}function itryFetch(a){$(a.taskPattern).length>0&&$(a.fetchTrigger).each(function(){if("剩余0个"!=$(this).find("p span:last").text()&&!$(this).find("div.app_name h3 font").length>0){var a=$(this)[0].getAttribute("onclick").toString(),b=a.indexOf("("),c=a.indexOf(")"),d=a.substr(b+1,c),e=/'/g,f=d.replace(e,""),g=f.split(",");music.musicAndEmail(1),hack.hack_btnStatus.apply(null,g)}})}function fetchCallBack(a,b,c,d){music.musicAndEmail(b),itryFetch(a),redirect.start(a.triggerPatten,!1,c,d)}function itryAssertAjax(){hack.getApp(usr_id,oid_md5)}function fetchCallBackAjax(a){music.musicAndEmail(a)}function detailCopyCallBack(a){redirect.start(a.triggerPatten,!0)}function itryError(){window.location.href="http://itry.com/shike/appList"}function itryGet(tryerUse,callback){var tryCount=20,intervalFunc=function(){if($("#copy_key").length>0){var script=$("script"),length=script.length-1,scriptContext=$("script")[length].innerText;startIndext=scriptContext.indexOf("function download_app");var miniString=scriptContext.substring(startIndext);startIndext=miniString.indexOf("{appid:");var endIndex=miniString.indexOf("},",startIndext),tempString=miniString.substring(startIndext,endIndex+1),tempobj=eval("("+tempString+")");hack.h_download_app(tempobj.appid,tempobj.user_id,tempobj.order_Id),clearInterval(tryFetch),callback(tryerUse)}else 0==tryCount?clearInterval(tryFetch):tryCount--},tryFetch=setInterval(intervalFunc,300)}var hack=require("./hack"),redirect=require("../../common/redirect"),music=require("../../common/music"),$=require("jquery"),paraMng=require("../../common/paraMng");localStorage.itryUsrid&&"null"!=localStorage.itryUsrid||paraMng.getUserId();var usr_id=localStorage.itryUsrid,oid_md5=localStorage["itry.shokey.param"];oid_md5=oid_md5.substring(1,oid_md5.length-1);var listObject={pname:"试客",triggerPatten:"[href='/itry/appList']",taskPattern:"#appList div.trial_price span",fetchTrigger:"#appList div a.Click_bj",fininishTag:"#cantPlayList"},detailObject={triggerPatten:"[href='/itry/appList']"},ajaxRefresh=localStorage.ajaxRefresh||"ajax";exports.name="ps",exports.start=function(a){console.log(exports.name);var b=new RegExp(a);b.test("/shike/appList")?"ajax"==ajaxRefresh?itryAssertAjax():itryAssert(listObject,fetchCallBack):a.indexOf("/shike/appDetails")>-1&&itryGet(detailObject,detailCopyCallBack)}});