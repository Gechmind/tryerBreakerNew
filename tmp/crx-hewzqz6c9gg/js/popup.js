function getCurrentTabUrl(a){var b={active:!0,currentWindow:!0};chrome.tabs.query(b,function(b){var c=b[0],d=c.url;console.assert("string"==typeof d,"tab.url should be a string"),a(d)})}function getImageUrl(a,b,c){var d="https://ajax.googleapis.com/ajax/services/search/images?v=1.0&q="+encodeURIComponent(a),e=new XMLHttpRequest;e.open("GET",d),e.responseType="json",e.onload=function(){var a=e.response;if(!a||!a.responseData||!a.responseData.results||0===a.responseData.results.length)return void c("No response from Google Image search!");var d=a.responseData.results[0],f=d.tbUrl,g=parseInt(d.tbWidth),h=parseInt(d.tbHeight);console.assert("string"==typeof f&&!isNaN(g)&&!isNaN(h),"Unexpected respose from the Google Image Search API!"),b(f,g,h)},e.onerror=function(){c("Network error.")},e.send()}function renderStatus(a){document.getElementById("status").textContent=a}document.addEventListener("DOMContentLoaded",function(){getCurrentTabUrl(function(a){renderStatus("Performing Google Image search for "+a),getImageUrl(a,function(b,c,d){renderStatus("Search term: "+a+"\nGoogle image search result: "+b);var e=document.getElementById("image-result");e.width=c,e.height=d,e.src=b,e.hidden=!1},function(a){renderStatus("Cannot display image. "+a)})})});